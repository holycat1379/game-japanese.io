{"version":3,"file":"Study copy-mpFqRJhp.js","sources":["../../src/pages/Study copy.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { isArray } from 'node:util'\nimport { useMediaControls } from '@vueuse/core'\nimport { ref } from 'vue'\n\nconst config = {\n  startIndex: 10,\n  endIndex: 18,\n}\nconst lessons = computed(() => {\n  return Array.from({ length: config.endIndex - config.startIndex + 1 }, (_, i) => {\n    return {\n      id: i + config.startIndex,\n      name: `第${i + config.startIndex}课`,\n      mp3: `japanese/mina-no-nihongo/${i + config.startIndex}.mp3`,\n      vtt: `japanese/mina-no-nihongo/${i + config.startIndex}.mp3.zh-CN-dual.vtt`,\n    }\n  })\n})\n\nconst currentLesson = reactive(lessons.value[0])\nconst video = ref()\nconst {\n  currentTime,\n  volume,\n  playing,\n  tracks,\n  duration,\n  enableTrack,\n} = useMediaControls(video, {\n  src: currentLesson.mp3,\n  tracks: [\n    {\n      default: true,\n      src: currentLesson.vtt,\n      kind: 'subtitles',\n      label: 'English',\n      srcLang: 'en',\n    },\n  ],\n})\nconst cues = reactive<{ startTime: number, endTime: number, text: string }[]>([])\n// 通过cues获得当前字幕\nconst currentCue = computed(() => {\n  if (tracks.value[0] && tracks.value[0].cues) {\n    const time = currentTime.value\n\n    for (const key in tracks.value[0].cues) {\n      const cue = tracks.value[0].cues[key]\n      if (cue.startTime <= time && cue.endTime >= time)\n        return cue.text\n    }\n  }\n})\n\nonMounted(() => {\n  volume.value = 0.5\n  currentTime.value = 0\n\n  // cues.push(...tracks.value[0].cues)\n  setTimeout(() => {\n    updateCurrentCue()\n  }, 2000)\n})\n\nfunction updateCurrentCue() {\n  // 获取 iframe 元素\n  const iframe = document.getElementById('myIframe')\n  console.log(currentCue.value, 2)\n\n  // 如果找到了 iframe 元素\n  if (iframe) {\n    // 获取 iframe 内部的文档对象\n    const iframeDocument = iframe.contentDocument || iframe.contentWindow.document\n\n    // 在 iframe 内部查找元素\n    const target = iframeDocument.getElementById('map_and_filter')\n\n    // 给target.nextElementSibling增加一个p元素\n\n    const container = target.nextElementSibling\n\n    container.children[1].innerText = currentCue.value\n    // 插入到container中第一个元素和第二个元素之间\n  }\n  else {\n    console.log('未找到指定的 iframe 元素')\n  }\n}\n\nwatchEffect(() => {\n  if (tracks.value[0] || currentTime.value) {\n    cues = tracks.value[0].cues\n    updateCurrentCue()\n  }\n})\n\nonKeyStroke(' ', (e) => {\n  playing.value = !playing.value\n  e.preventDefault()\n})\n</script>\n\n<template>\n  <div>\n    <iframe id=\"myIframe\" src=\"test-html/Looping code - Learn web development _ MDN.html\" class=\"iframe\" />\n    {{ currentCue }}    {{ currentTime }}| {{ duration }}\n    {{ cues }}\n    <video ref=\"video\" />\n  </div>\n</template>\n\n<style scoped>\n.iframe {\n  width: 100vw;\n  height: 100vh;\n}\n</style>\n"],"names":["config","lessons","computed","_","i","currentLesson","reactive","video","ref","currentTime","volume","playing","tracks","duration","enableTrack","useMediaControls","cues","currentCue","time","key","cue","onMounted","updateCurrentCue","iframe","container","watchEffect","onKeyStroke"],"mappings":"0VAKA,MAAMA,EAAS,CACb,WAAY,GACZ,SAAU,EAAA,EAENC,EAAUC,EAAS,IAChB,MAAM,KAAK,CAAE,OAAQF,EAAO,SAAWA,EAAO,WAAa,CAAE,EAAG,CAACG,EAAGC,KAClE,CACL,GAAIA,EAAIJ,EAAO,WACf,KAAM,IAAII,EAAIJ,EAAO,UAAU,IAC/B,IAAK,4BAA4BI,EAAIJ,EAAO,UAAU,OACtD,IAAK,4BAA4BI,EAAIJ,EAAO,UAAU,qBAAA,EAEzD,CACF,EAEKK,EAAgBC,EAASL,EAAQ,MAAM,CAAC,CAAC,EACzCM,EAAQC,IACR,CACJ,YAAAC,EACA,OAAAC,EACA,QAAAC,EACA,OAAAC,EACA,SAAAC,EACA,YAAAC,CAAA,EACEC,EAAiBR,EAAO,CAC1B,IAAKF,EAAc,IACnB,OAAQ,CACN,CACE,QAAS,GACT,IAAKA,EAAc,IACnB,KAAM,YACN,MAAO,UACP,QAAS,IACX,CACF,CAAA,CACD,EACKW,EAAOV,EAAiE,CAAA,CAAE,EAE1EW,EAAaf,EAAS,IAAM,CAC5B,GAAAU,EAAO,MAAM,CAAC,GAAKA,EAAO,MAAM,CAAC,EAAE,KAAM,CAC3C,MAAMM,EAAOT,EAAY,MAEzB,UAAWU,KAAOP,EAAO,MAAM,CAAC,EAAE,KAAM,CACtC,MAAMQ,EAAMR,EAAO,MAAM,CAAC,EAAE,KAAKO,CAAG,EACpC,GAAIC,EAAI,WAAaF,GAAQE,EAAI,SAAWF,EAC1C,OAAOE,EAAI,IACf,CACF,CAAA,CACD,EAEDC,EAAU,IAAM,CACdX,EAAO,MAAQ,GACfD,EAAY,MAAQ,EAGpB,WAAW,IAAM,CACEa,KAChB,GAAI,CAAA,CACR,EAED,SAASA,GAAmB,CAEpB,MAAAC,EAAS,SAAS,eAAe,UAAU,EAIjD,GAHQ,QAAA,IAAIN,EAAW,MAAO,CAAC,EAG3BM,EAAQ,CASV,MAAMC,GAPiBD,EAAO,iBAAmBA,EAAO,cAAc,UAGxC,eAAe,gBAAgB,EAIpC,mBAEzBC,EAAU,SAAS,CAAC,EAAE,UAAYP,EAAW,KAAA,MAI7C,QAAQ,IAAI,kBAAkB,CAElC,CAEA,OAAAQ,EAAY,IAAM,EACZb,EAAO,MAAM,CAAC,GAAKH,EAAY,SAC1BO,EAAAJ,EAAO,MAAM,CAAC,EAAE,KACNU,IACnB,CACD,EAEWI,EAAA,IAAM,GAAM,CACdf,EAAA,MAAQ,CAACA,EAAQ,MACzB,EAAE,eAAe,CAAA,CAClB"}