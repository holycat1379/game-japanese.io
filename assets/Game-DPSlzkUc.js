import{d as E,o as i,a as u,b as l,t as y,F as $,e as A,_ as T,f as N,r as S,g as I,w as G,h as se,i as O,j as b,u as m,p as X,k as ee,l as B,m as oe,n as H,q as P,s as te,v as K,x as ce,y as de,z as F,T as q,c as ie}from"./index-hgGKhKni.js";const le={key:0},ue={key:1},he={key:2},fe=E({__name:"Card",props:{card:null},setup(t){return(e,r)=>(i(),u("div",null,[t.card?(i(),u("div",le,[l("p",null,"Name: "+y(t.card.name),1),l("p",null,"Description: "+y(t.card.description),1),"physicalAttack"in t.card?(i(),u($,{key:0},[l("p",null,"BaseATK:"+y(t.card.physicalAttack),1),l("p",null," ^ATK:"+y(t.card.extraAttack),1)],64)):A("",!0),"shield"in t.card?(i(),u("p",ue,"Shield:"+y(t.card.shield),1)):A("",!0),"increaseAmount"in t.card?(i(),u("p",he,"IncreaseAttack:"+y(t.card.increaseAmount),1)):A("",!0)])):A("",!0)]))}}),ae=T(fe,[["__scopeId","data-v-c684132d"]]);var J=(t=>(t.Attack="Attack",t.Defend="Defend",t.Skill="Skill",t))(J||{}),L=(t=>(t.Self="Self",t.Enemy="Enemy",t))(L||{});class Y{constructor(e,r,a,s,o){this.name=e,this.description=r,this.cost=a,this.type=s,this.targetType=o,this.id=Math.random().toString(36).substr(2,9),this.position="hand",this.status="INACTIVE"}}class U extends Y{constructor(e,r,a,s=5){super(e,r,a,J.Attack,L.Enemy),this.shield=s,this.extraShield=0}increase(e){this.extraShield+=e}reduce(e){this.extraShield-=e}play(e){e.increaseShield(this.shield+this.extraShield)}}class Q extends Y{constructor(e,r,a,s,o){super(e,r,a,s),this.increaseAmount=o,this.targetType=L.Self}getIncreaseAmount(){return this.increaseAmount}setIncreaseAmount(e){this.increaseAmount=e}play(e){e.extraAttack+=this.increaseAmount}}class Z extends Y{constructor(e,r,a,s){super(e,r,a,J.Attack,L.Enemy),this.physicalAttack=s,this.extraAttack=0}increaseAttack(e){this.extraAttack+=e}reduceAttack(e){this.extraAttack-=e}play(e){e.takeDamage(this.physicalAttack+this.extraAttack)}}const R=N("handManager",()=>{const t=new Z("Sword","sword attack",1,20),e=new Q("IncreaseAttack","IncreaseAttac",4,"effect",2),r=new U("Shield","incrase Shield",1,5),a=S([t,e,r]);let s=S([t,e,r]);const o=S([]),v=()=>[e,t,t,e,r],g=()=>{for(let f=s.length-1;f>0;f--){const d=Math.floor(Math.random()*(f+1)),p=s[f];s[f]=s[d],s[d]=p}},n=(f=1)=>{const d=[];for(let p=0;p<f;p++){const _=Math.floor(Math.random()*a.length),x=a[_];d.push({...x})}return d},c=f=>{if(f==="IncreaseAttack")o.push(new Q("IncreaseAttack","IncreaseAttac",4,"effect",2));else if(f==="Shield")o.push(new U("Shield","incrase Shield",1,5));else if(f==="Sword")o.push(new Z("Sword","sword attack",1,20));else throw new Error("Card not found")},k=f=>{if(f>s.length)throw new Error("Not enough cards in the deck");const d=s.slice(0,f);return s=s.slice(f),d},C=f=>{k(f).forEach(p=>{c(p.name)})};return{draw:k,shuffle:g,drawCardToHand:C,init:()=>{a.splice(0,a.length,...v()),s.splice(0,s.length,...v()),C(3)},allCards:a,deckCards:s,handCards:o,getLevelCards:n,addCardToHandById:f=>{const d=a.find(p=>p.id===f);if(!d)throw new Error("Card not found");c(d.name)}}});class re{constructor(e,r,a){this.name=e,this.health=r,this.msg="",this.msgType="Attack",this.shield=a}setMsg(e,r="Info"){this.msg=e,this.msgType=r,setTimeout(()=>{this.msg=""},500)}takeDamage(e){let r=e-this.shield;r<=0?(this.shield-=e,r=0):this.shield=0,this.health-=r,this.health<=0?(this.health=0,this.died()):this.setMsg(`-${e}`,"Attack")}increaseShield(e){this.setMsg(`+ ${e} .`,"Heal"),this.shield+=e}died(){this.health=0,this.setMsg(`${this.name} is dead!`)}}class pe extends re{constructor(e,r,a){super(e,r,a)}}class W extends re{constructor(e,r,a,s){super(e,r,s),this.physicalAttack=a}died(){super.died(),this.setMsg(`${this.name} is dead!`)}}const z=N("gameManager",()=>{const t=I("START_MENU");return{player:I(new pe("Summer",100,0)),scene:t,win:()=>{t.value="GAME_WIN"},init:()=>{t.value="GAME"},lose:()=>{t.value="GAME_LOSE"}}}),j=N("levelManager",()=>{const t=I(1),e=I(!1),r=z(),a=S([new W("DoodGuy",50,6,0),new W("NormalGuy",30,12,16),new W("BadGuy",80,18,0)]),s=I(a[0]),o=()=>{t.value=1,s.value=a[0]},v=()=>{e.value=!0},g=()=>{if(t.value>=a.length){r.win();return}v()},n=()=>{e.value=!1,t.value+=1,s.value=a[t.value-1]};return G(()=>s.value.health,c=>{c<=0&&g()}),{enemy:s,level:t,init:o,nextLevel:g,openLevelOverDraw:v,closeLevelOverDraw:n,isShowLevelOverDraw:e}}),ge=t=>(X("data-v-2b1852a5"),t=t(),ee(),t),me={class:"card-selection"},_e={class:"card-container border"},ve=["onClick"],ye=ge(()=>l("div",{class:"overlay"},null,-1)),xe=E({__name:"LevelOverDraw",setup(t){const e=R(),r=j(),a=S([]);se(()=>{a.push(...e.getLevelCards(3))});function s(o){e.addCardToHandById(o),r.closeLevelOverDraw()}return(o,v)=>{const g=ae;return i(),u("div",me,[l("div",_e,[(i(!0),u($,null,O(m(a),(n,c)=>(i(),u("div",{key:c,class:"card",onClick:k=>s(n.id)},[b(g,{card:n},null,8,["card"]),ye],8,ve))),128))])])}}}),ke=T(xe,[["__scopeId","data-v-2b1852a5"]]),Ce={class:"hand-cards-container m-auto h-300px w-300px flex flex-row gap-2 overflow-auto border border-dark-50 rounded bg-gray-500/5 p-4"},we=["data-x","onDragstart"],Ae=E({__name:"HandCards",setup(t){const e=R();function r(a,s){a.dataTransfer&&a.dataTransfer.setData("text/plain",JSON.stringify({card:s,from:"HAND"}))}return(a,s)=>{const o=ae;return i(),u("div",Ce,[(i(!0),u($,null,O(m(e).handCards,(v,g)=>(i(),u("div",{key:v.id,"data-x":g,draggable:!0,class:"h-30 cursor-move border border-dark-50 rounded bg-gray-500/5 p-3",onDragstart:n=>r(n,v)},[b(o,{card:v},null,8,["card"])],40,we))),128))])}}}),De=T(Ae,[["__scopeId","data-v-105edaa3"]]),Ie={class:"text"},be={key:0},Se={key:1},Ee={key:2},Te={key:0,class:"action-msg"},$e=E({__name:"WeaponCard",props:{card:null,active:{type:Boolean}},setup(t){const e=t,r=B(()=>({active:e.active})),a=B(()=>"physicalAttack"in e.card?{text:`^ATK${e.card.physicalAttack+e.card.extraAttack}`,color:"attack"}:"shield"in e.card?{text:`^Shield${e.card.shield}`,color:"shield"}:"increaseAmount"in e.card?{text:`IncreaseAttack:${e.card.increaseAmount}`,color:"info"}:{text:"",color:"info"});return(s,o)=>{const v=oe("motion-pop");return t.card?(i(),u("div",{key:0,class:P(m(r))},[l("div",Ie,[l("p",null,"Name: "+y(t.card.name),1),"physicalAttack"in t.card?(i(),u("p",be,"ATK:"+y(t.card.physicalAttack+t.card.extraAttack),1)):A("",!0),"shield"in t.card?(i(),u("p",Se,"Shield:"+y(t.card.shield),1)):A("",!0),"increaseAmount"in t.card?(i(),u("p",Ee,"IncreaseAttack:"+y(t.card.increaseAmount),1)):A("",!0)]),t.active?(i(),u("div",Te,[H((i(),u("div",{class:P([m(a).color])},[te(y(m(a).text),1)],2)),[[v]])])):A("",!0)],2)):A("",!0)}}}),Me=T($e,[["__scopeId","data-v-fbf91766"]]),V=N("weaponManager",()=>{const t=R(),e=S([]),r=I(""),a=d=>{r.value=d},s=S({name:"Nine",height:3,width:3}),o=S(v(s.width,s.height));function v(d,p){const _=[];for(let x=0;x<d;x++){const w=[];for(let M=0;M<p;M++){const ne={x,y:M,card:null};w.push(ne)}_.push(w)}return _}function g(d){for(const p of o)for(const _ of p)if(_&&_.card&&_.card.id===d)return _;return null}function n(d){const p=g(d);return p?p.card:null}const c=({fromCardId:d,toX:p,toY:_})=>{const x=g(d),w=o[p][_];if(!w.card)w.card=x.card,x.card=null;else{const M={...w.card};w.card=x.card,x.card=M}},k=({fromCardId:d,toX:p,toY:_})=>{const x=t.handCards.find(w=>w.id===d);if(!x)throw new Error("Card not found in hand cards");if(t.handCards.splice(t.handCards.indexOf(x),1),o[p][_].card===null)o[p][_].card=x;else{const w={...o[p][_].card};o[p][_].card=x,t.handCards.push(w)}},C=B(()=>{const d=[];for(const p of o)for(const _ of p)_&&_.card&&d.push(_.card.id);return d}),h=d=>n(e[d]);function D(d){const p=g(d),_=[];for(let x=p.x+1;x<s.width;x++){const w=o[x][p.y];w.card&&_.push(w.card)}return _}return{activeCardId:r,setActiveCardId:a,getCardByCardId:n,getRightCards:d=>D(d.id),getCardByOrderIndex:h,orderIds:e,weaponCardIds:C,weaponGrid:o,addHandCardToWeapon:k,addWeaponCardToWeapon:c}});function Oe(t,e){const r=t.children;for(let a=0;a<r.length;a++)if(r[a]===e)return a;return-1}function Ne(t,e,r){const a=t[e];t[e]=t[r],t[r]=a}const Le=["onDragstart","onDragenter"],Re={draggable:!1,class:"pointer-events-none select-none"},We={class:"number-bg absolute left-0 top-0 z-0 h-30 w-30 text-center text-white opacity-10",style:{"font-size":"90px"}},Be={class:""},He=E({__name:"OrderCards",setup(t){const e=V(),r=I(null);G(()=>e.weaponCardIds,()=>{e.orderIds.splice(0,e.orderIds.length,...e.weaponCardIds)});function a(n,c){n.dataTransfer&&n.dataTransfer.setData("text/plain",JSON.stringify({fromIndex:c}))}function s(n){if(!n||!n.dataTransfer||!n.dataTransfer.getData("text")||!r.value)return;const c=n.target,{fromIndex:k}=JSON.parse(n.dataTransfer.getData("text")),C=Oe(r.value,c);Ne(e.orderIds,k,C),c.classList.remove("ghost")}function o(n){n.target.classList.add("ghost"),n.preventDefault()}function v(n){n.target.classList.remove("ghost"),n.preventDefault()}function g(n,c){if(!n||!n.dataTransfer||!n.dataTransfer.getData("text")||!r.value)return;const{fromIndex:k}=JSON.parse(n.dataTransfer.getData("text"));n.dataTransfer.setData("text/plain",JSON.stringify({fromIndex:k,toIndex:c}))}return(n,c)=>(i(),u("div",null,[te(y(m(e).orderIds)+" ",1),l("div",{ref_key:"orderIdsRef",ref:r,class:"m-auto h-200px w-700px flex flex-row gap-2 overflow-auto border border-dark-50 rounded bg-gray-500/5 p-4"},[(i(!0),u($,null,O(m(e).orderIds,(k,C)=>(i(),u("div",{key:k,class:"relative z-10 h-30 w-30 cursor-move border border-dark-50 rounded bg-gray-500/5 p-3",draggable:!0,onDragstart:h=>a(h,C),onDragover:o,onDrop:s,onDragleave:v,onDragenter:h=>g(h,C)},[l("div",Re,[l("span",We,y(C+1),1),l("p",Be,y(m(e).getCardByCardId(k).name),1)])],40,Le))),128))],512)]))}}),Pe=T(He,[["__scopeId","data-v-e43e874a"]]),Ge={class:"h-10 w-40 flex items-center justify-center"},Je=["data-x","data-y"],Ye=["data-x","data-y","onDragstart"],ze={class:"pointer-events-none"},je=E({__name:"WeaponCards",setup(t){const e=V();function r(n,c){n.dataTransfer&&n.dataTransfer.setData("text/plain",JSON.stringify({card:c,from:"WEAPON"}))}const a=I(null);function s(n){if(!n||!n.dataTransfer||!n.dataTransfer.getData("text"))return;const c=n.target,{card:k,from:C}=JSON.parse(n.dataTransfer.getData("text"));c.classList.remove("ghost");const h=c.getAttribute("data-x"),D=c.getAttribute("data-y");if(h===null||D===null)return;const f={fromCardId:k.id,toX:Number.parseInt(h),toY:Number.parseInt(D)};C==="WEAPON"&&e.addWeaponCardToWeapon(f),C==="HAND"&&e.addHandCardToWeapon(f)}function o(n){n.target.classList.add("ghost"),n.preventDefault()}function v(n){n.target.classList.remove("ghost"),n.preventDefault()}const g=I("WEAPON");return(n,c)=>{const k=Pe,C=Me;return i(),u("div",null,[l("div",Ge,[l("button",{class:"border",onClick:c[0]||(c[0]=h=>g.value="ORDER")}," ORDER "),l("button",{class:"border",onClick:c[1]||(c[1]=h=>g.value="WEAPON")}," WEAPON ")]),H(b(k,{class:"order-cards"},null,512),[[K,m(g)==="ORDER"]]),H(l("div",{ref_key:"weaponCardsRef",ref:a,class:"weapon-cards m-auto h-400px w-600px flex flex-row gap-2 overflow-auto border border-dark-50 rounded bg-gray-500/5 p-4"},[(i(!0),u($,null,O(m(e).weaponGrid,(h,D)=>(i(),u("div",{key:D,class:"row"},[(i(!0),u($,null,O(h,({card:f,x:d,y:p},_)=>(i(),u("div",{key:_,class:"col"},[f?(i(),u("div",{key:1,draggable:!0,"data-x":d,"data-y":p,class:"h-30 cursor-move overflow-hidden border border border-dark-50 rounded bg-gray-500/5 p-3",onDragstart:x=>r(x,f),onDragover:o,onDrop:s,onDragleave:v},[l("div",ze,[b(C,{card:f,active:m(e).activeCardId===f.id},null,8,["card","active"])])],40,Ye)):(i(),u("div",{key:0,"data-x":d,"data-y":p,class:"empty h-30 cursor-move overflow-hidden border border border-dark-50 rounded bg-gray-500/5 p-3",onDragover:o,onDrop:s,onDragleave:v},null,40,Je))]))),128))]))),128))],512),[[K,m(g)==="WEAPON"]])])}}}),Ve=T(je,[["__scopeId","data-v-5b6ffaf7"]]),Ke=N("turnManager",()=>{let t;(h=>{h.READY="READY",h.PLAYER="PLAYER",h.OPPONENT="OPPONENT",h.ENDED="ENDED"})(t||(t={}));const e=I("PLAYER"),{counter:r,reset:a,pause:s,resume:o}=ce(700,{controls:!0,immediate:!1}),v=z(),g=j(),n=V();function c(){a(),e.value="READY"}function k(){o(),e.value="PLAYER"}G(()=>r.value,()=>{if(r.value<=0)return;const h=n.getCardByOrderIndex(r.value-1);if(h){if(n.setActiveCardId(h.id),"physicalAttack"in h){let D=0;h.physicalAttack?D=h.physicalAttack+h.extraAttack:D=0,g.enemy.takeDamage(D)}"shield"in h&&v.player.increaseShield(h.shield),"increaseAmount"in h&&n.getRightCards(h).forEach(f=>{h.play(f)}),n.getCardByOrderIndex(r.value)||setTimeout(()=>{C()},1e3)}});function C(){s(),a(),v.player.takeDamage(g.enemy.physicalAttack),n.setActiveCardId("")}return{startTurn:k,init:c}}),Fe=t=>(X("data-v-6bf0e790"),t=t(),ee(),t),qe={class:"game-container"},Ue={class:"test flex flex-col items-center justify-center"},Qe={class:"player"},Ze={class:"msg h-10 w-40"},Xe={class:"enemy"},et={class:"msg h-10 w-40 text-red-100"},tt={key:0},at={key:0,class:"text-1xl fixed bottom-0 left-0 right-0 top-0 z-50 h-full w-full flex flex-col items-center justify-center text-green-100"},rt=Fe(()=>l("div",{class:"text-2xl"}," You Win! ",-1)),nt=E({__name:"Game",setup(t){const e=z(),r=Ke(),a=j(),s=R();de(()=>{o()});function o(){a.init(),s.init(),r.init(),e.init()}return(v,g)=>{const n=Ve,c=De,k=ke;return i(),u("div",qe,[l("div",Ue,[l("button",{class:"border-button border",onClick:g[0]||(g[0]=C=>m(r).startTurn())}," StartTurn ")]),l("div",Qe,[l("div",Ze,[b(q,null,{default:F(()=>[m(e).player.msg?(i(),u("p",{key:0,class:P(m(e).player.msgType==="Heal"?"text-green-100":"text-red-100")},y(m(e).player.msg),3)):A("",!0)]),_:1})]),l("h2",null,y(m(e).player.name),1),l("p",null,"Health: "+y(m(e).player.health),1),l("p",null,"Shield: "+y(m(e).player.shield),1)]),l("div",Xe,[l("div",et,[b(q,null,{default:F(()=>[m(a).enemy.msg?(i(),u("p",tt,y(m(a).enemy.msg),1)):A("",!0)]),_:1})]),l("h2",null,y(m(a).enemy.name),1),l("p",null,"Health: "+y(m(a).enemy.health),1),l("p",null,"Atk: "+y(m(a).enemy.physicalAttack),1)]),b(n,{class:"weapon-cards"}),b(c,{class:"hand-cards"}),m(e).scene==="GAME_WIN"?(i(),u("div",at,[rt,l("button",{class:"border-button text-1xl mt-10 border",onClick:g[1]||(g[1]=C=>o())}," Play Again ")])):A("",!0),m(a).isShowLevelOverDraw?(i(),ie(k,{key:1})):A("",!0)])}}}),ot=T(nt,[["__scopeId","data-v-6bf0e790"]]);export{ot as default};
//# sourceMappingURL=Game-DPSlzkUc.js.map
